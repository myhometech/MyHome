<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile QA Testing - MyHome Document Management</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
        }
        .test-button {
            background: #007AFF;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            margin: 5px;
            min-height: 44px;
            min-width: 44px;
        }
        .test-button:hover {
            background: #0056B3;
        }
        .test-result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 14px;
        }
        .success { background: #d4edda; color: #155724; }
        .warning { background: #fff3cd; color: #856404; }
        .error { background: #f8d7da; color: #721c24; }
        .touch-test {
            width: 150px;
            height: 150px;
            background: #e9ecef;
            border: 2px dashed #6c757d;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 10px 0;
            user-select: none;
            touch-action: pan-x pan-y;
        }
        .device-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        .camera-preview {
            width: 100%;
            max-width: 300px;
            height: 200px;
            background: #000;
            border-radius: 4px;
            display: none;
        }
        input[type="file"] {
            font-size: 16px;
            padding: 10px;
            margin: 5px 0;
        }
        .responsive-test {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 6px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üì± Mobile QA Testing Suite</h1>
        
        <div class="device-info">
            <h3>Device Information</h3>
            <div id="deviceInfo">Loading device info...</div>
        </div>

        <!-- Responsive Layout Test -->
        <div class="test-section">
            <h3>1. Responsive Layout Test</h3>
            <div class="responsive-test">
                <p>Viewport: <span id="viewportSize">Loading...</span></p>
                <p>Screen: <span id="screenSize">Loading...</span></p>
                <p>Device Pixel Ratio: <span id="pixelRatio">Loading...</span></p>
            </div>
            <button class="test-button" onclick="testResponsive()">Test Layout</button>
            <div id="responsiveResult" class="test-result"></div>
        </div>

        <!-- Touch Gesture Test -->
        <div class="test-section">
            <h3>2. Touch Gesture Test</h3>
            <div class="touch-test" id="touchArea" ontouchstart="handleTouch(event)" 
                 ontouchmove="handleTouchMove(event)" ontouchend="handleTouchEnd(event)">
                Touch here to test gestures
            </div>
            <button class="test-button" onclick="resetTouchTest()">Reset</button>
            <div id="touchResult" class="test-result"></div>
        </div>

        <!-- Camera Test -->
        <div class="test-section">
            <h3>3. Camera & File Upload Test</h3>
            <input type="file" accept="image/*" capture="environment" id="cameraInput" 
                   onchange="handleFileSelect(event)">
            <button class="test-button" onclick="testCameraAPI()">Test Camera API</button>
            <video id="cameraPreview" class="camera-preview" autoplay playsinline></video>
            <div id="cameraResult" class="test-result"></div>
        </div>

        <!-- Form Input Test -->
        <div class="test-section">
            <h3>4. Form Input Test (iOS Zoom Prevention)</h3>
            <input type="text" placeholder="Test input (16px font)" style="font-size: 16px; padding: 10px;">
            <input type="email" placeholder="Email input" style="font-size: 16px; padding: 10px;">
            <textarea placeholder="Textarea test" style="font-size: 16px; padding: 10px;"></textarea>
            <button class="test-button" onclick="testFormInputs()">Test Inputs</button>
            <div id="formResult" class="test-result"></div>
        </div>

        <!-- Performance Test -->
        <div class="test-section">
            <h3>5. Performance Test</h3>
            <button class="test-button" onclick="testPerformance()">Run Performance Test</button>
            <div id="performanceResult" class="test-result"></div>
        </div>

        <!-- Network Test -->
        <div class="test-section">
            <h3>6. Network Connectivity Test</h3>
            <button class="test-button" onclick="testNetwork()">Test Network</button>
            <div id="networkResult" class="test-result"></div>
        </div>

        <!-- Overall Results -->
        <div class="test-section">
            <h3>üìä Test Summary</h3>
            <button class="test-button" onclick="runAllTests()" style="background: #28a745;">Run All Tests</button>
            <div id="overallResult" class="test-result"></div>
        </div>
    </div>

    <script>
        let testResults = {};
        let touchStartX = 0, touchStartY = 0;
        let touchStartTime = 0;

        // Initialize device info
        window.addEventListener('load', function() {
            updateDeviceInfo();
            updateViewportInfo();
        });

        window.addEventListener('resize', updateViewportInfo);

        function updateDeviceInfo() {
            const info = {
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                language: navigator.language,
                cookieEnabled: navigator.cookieEnabled,
                onLine: navigator.onLine,
                touchSupport: 'ontouchstart' in window,
                deviceMemory: navigator.deviceMemory || 'Unknown',
                hardwareConcurrency: navigator.hardwareConcurrency || 'Unknown'
            };

            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
            const isAndroid = /Android/.test(navigator.userAgent);
            const isMobile = /Mobi|Android/i.test(navigator.userAgent);

            document.getElementById('deviceInfo').innerHTML = `
                <strong>Platform:</strong> ${isIOS ? 'iOS' : isAndroid ? 'Android' : 'Other'}<br>
                <strong>Mobile:</strong> ${isMobile ? 'Yes' : 'No'}<br>
                <strong>Touch Support:</strong> ${info.touchSupport ? 'Yes' : 'No'}<br>
                <strong>Online:</strong> ${info.onLine ? 'Yes' : 'No'}<br>
                <strong>CPU Cores:</strong> ${info.hardwareConcurrency}<br>
                <strong>Device Memory:</strong> ${info.deviceMemory} GB
            `;
        }

        function updateViewportInfo() {
            const viewport = {
                width: window.innerWidth,
                height: window.innerHeight,
                screenWidth: screen.width,
                screenHeight: screen.height,
                pixelRatio: window.devicePixelRatio
            };

            document.getElementById('viewportSize').textContent = `${viewport.width}x${viewport.height}`;
            document.getElementById('screenSize').textContent = `${viewport.screenWidth}x${viewport.screenHeight}`;
            document.getElementById('pixelRatio').textContent = viewport.pixelRatio;
        }

        function testResponsive() {
            const results = [];
            const viewport = window.innerWidth;
            
            // Test breakpoints
            if (viewport <= 480) {
                results.push('‚úÖ Mobile breakpoint active (‚â§480px)');
            } else if (viewport <= 768) {
                results.push('‚úÖ Tablet breakpoint active (481-768px)');
            } else {
                results.push('‚úÖ Desktop breakpoint active (>768px)');
            }

            // Test for horizontal scroll
            if (document.body.scrollWidth > viewport) {
                results.push('‚ùå Horizontal scroll detected');
            } else {
                results.push('‚úÖ No horizontal scroll');
            }

            // Test touch target sizes
            const buttons = document.querySelectorAll('.test-button');
            let smallButtons = 0;
            buttons.forEach(btn => {
                const rect = btn.getBoundingClientRect();
                if (rect.width < 44 || rect.height < 44) {
                    smallButtons++;
                }
            });

            if (smallButtons === 0) {
                results.push('‚úÖ All buttons meet touch target size (44px)');
            } else {
                results.push(`‚ö†Ô∏è ${smallButtons} buttons below recommended touch target size`);
            }

            testResults.responsive = results.length > 0 && !results.some(r => r.includes('‚ùå'));
            displayResult('responsiveResult', results, testResults.responsive);
        }

        function handleTouch(event) {
            const touch = event.touches[0];
            touchStartX = touch.clientX;
            touchStartY = touch.clientY;
            touchStartTime = Date.now();
            
            document.getElementById('touchResult').innerHTML = 
                '<div class="success">Touch started at: ' + touchStartX + ', ' + touchStartY + '</div>';
        }

        function handleTouchMove(event) {
            event.preventDefault(); // Prevent scrolling
            const touch = event.touches[0];
            const deltaX = touch.clientX - touchStartX;
            const deltaY = touch.clientY - touchStartY;
            
            document.getElementById('touchResult').innerHTML = 
                '<div class="warning">Touch move delta: ' + deltaX + ', ' + deltaY + '</div>';
        }

        function handleTouchEnd(event) {
            const touchEndTime = Date.now();
            const duration = touchEndTime - touchStartTime;
            const touch = event.changedTouches[0];
            const deltaX = touch.clientX - touchStartX;
            const deltaY = touch.clientY - touchStartY;
            const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
            
            let gestureType = 'tap';
            if (distance > 50) {
                if (Math.abs(deltaX) > Math.abs(deltaY)) {
                    gestureType = deltaX > 0 ? 'swipe right' : 'swipe left';
                } else {
                    gestureType = deltaY > 0 ? 'swipe down' : 'swipe up';
                }
            } else if (duration > 500) {
                gestureType = 'long press';
            }
            
            const results = [
                `‚úÖ Gesture detected: ${gestureType}`,
                `‚úÖ Duration: ${duration}ms`,
                `‚úÖ Distance: ${distance.toFixed(1)}px`
            ];

            testResults.touch = true;
            displayResult('touchResult', results, true);
        }

        function resetTouchTest() {
            document.getElementById('touchResult').innerHTML = '';
        }

        async function testCameraAPI() {
            const results = [];
            
            try {
                // Test MediaDevices API availability
                if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                    results.push('‚úÖ Camera API available');
                    
                    // Test camera access
                    const stream = await navigator.mediaDevices.getUserMedia({ 
                        video: { facingMode: 'environment' } 
                    });
                    
                    results.push('‚úÖ Camera access granted');
                    
                    // Display camera preview
                    const video = document.getElementById('cameraPreview');
                    video.srcObject = stream;
                    video.style.display = 'block';
                    results.push('‚úÖ Camera preview active');
                    
                    // Stop camera after 3 seconds
                    setTimeout(() => {
                        stream.getTracks().forEach(track => track.stop());
                        video.style.display = 'none';
                    }, 3000);
                    
                    testResults.camera = true;
                } else {
                    results.push('‚ùå Camera API not available');
                    testResults.camera = false;
                }
            } catch (error) {
                results.push(`‚ùå Camera error: ${error.message}`);
                testResults.camera = false;
            }
            
            displayResult('cameraResult', results, testResults.camera);
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            const results = [];
            
            if (file) {
                results.push(`‚úÖ File selected: ${file.name}`);
                results.push(`‚úÖ File size: ${(file.size / 1024).toFixed(1)} KB`);
                results.push(`‚úÖ File type: ${file.type}`);
                
                // Test file reading
                const reader = new FileReader();
                reader.onload = function(e) {
                    results.push('‚úÖ File reading successful');
                    displayResult('cameraResult', results, true);
                };
                reader.readAsDataURL(file);
            } else {
                results.push('‚ö†Ô∏è No file selected');
                displayResult('cameraResult', results, false);
            }
        }

        function testFormInputs() {
            const inputs = document.querySelectorAll('input, textarea');
            const results = [];
            let zoomIssues = 0;
            
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
            
            inputs.forEach(input => {
                const styles = window.getComputedStyle(input);
                const fontSize = parseInt(styles.fontSize);
                
                if (isIOS && fontSize < 16) {
                    zoomIssues++;
                }
            });
            
            if (isIOS) {
                if (zoomIssues === 0) {
                    results.push('‚úÖ All inputs have font-size ‚â•16px (iOS zoom prevention)');
                } else {
                    results.push(`‚ùå ${zoomIssues} inputs will cause zoom on iOS`);
                }
            } else {
                results.push('‚úÖ iOS zoom test not applicable on this device');
            }
            
            results.push(`‚úÖ Total inputs tested: ${inputs.length}`);
            
            testResults.forms = zoomIssues === 0;
            displayResult('formResult', results, testResults.forms);
        }

        function testPerformance() {
            const results = [];
            const startTime = performance.now();
            
            // Test various performance metrics
            const paintMetrics = performance.getEntriesByType('paint');
            paintMetrics.forEach(metric => {
                results.push(`‚úÖ ${metric.name}: ${metric.startTime.toFixed(1)}ms`);
            });
            
            // Test memory (if available)
            if (performance.memory) {
                const memory = performance.memory;
                results.push(`‚úÖ JS Heap: ${(memory.usedJSHeapSize / 1024 / 1024).toFixed(1)}MB`);
            }
            
            // Test connection (if available)
            if (navigator.connection) {
                const conn = navigator.connection;
                results.push(`‚úÖ Connection: ${conn.effectiveType} (${conn.downlink}Mbps)`);
            }
            
            // Test DOM performance
            const domStart = performance.now();
            document.querySelectorAll('*').length;
            const domTime = performance.now() - domStart;
            results.push(`‚úÖ DOM query time: ${domTime.toFixed(2)}ms`);
            
            const totalTime = performance.now() - startTime;
            results.push(`‚úÖ Performance test completed in: ${totalTime.toFixed(1)}ms`);
            
            testResults.performance = totalTime < 100;
            displayResult('performanceResult', results, testResults.performance);
        }

        function testNetwork() {
            const results = [];
            const startTime = performance.now();
            
            // Test online status
            results.push(`‚úÖ Online status: ${navigator.onLine ? 'Connected' : 'Offline'}`);
            
            // Test fetch performance
            fetch('data:text/plain,test')
                .then(() => {
                    const fetchTime = performance.now() - startTime;
                    results.push(`‚úÖ Fetch test: ${fetchTime.toFixed(1)}ms`);
                    testResults.network = true;
                    displayResult('networkResult', results, true);
                })
                .catch(error => {
                    results.push(`‚ùå Fetch error: ${error.message}`);
                    testResults.network = false;
                    displayResult('networkResult', results, false);
                });
        }

        function displayResult(elementId, results, passed) {
            const element = document.getElementById(elementId);
            const className = passed ? 'success' : 'error';
            element.innerHTML = `<div class="${className}">${results.join('<br>')}</div>`;
        }

        async function runAllTests() {
            const overallElement = document.getElementById('overallResult');
            overallElement.innerHTML = '<div class="warning">Running all tests...</div>';
            
            // Run all tests
            testResponsive();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            testFormInputs();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            testPerformance();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            testNetwork();
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            // Calculate overall results
            const totalTests = Object.keys(testResults).length;
            const passedTests = Object.values(testResults).filter(result => result).length;
            const passRate = ((passedTests / totalTests) * 100).toFixed(1);
            
            const summary = [
                `üìä Test Summary: ${passedTests}/${totalTests} passed (${passRate}%)`,
                `‚úÖ Responsive Layout: ${testResults.responsive ? 'PASS' : 'FAIL'}`,
                `‚úÖ Touch Gestures: ${testResults.touch ? 'PASS' : 'FAIL'}`,
                `‚úÖ Form Inputs: ${testResults.forms ? 'PASS' : 'FAIL'}`,
                `‚úÖ Performance: ${testResults.performance ? 'PASS' : 'FAIL'}`,
                `‚úÖ Network: ${testResults.network ? 'PASS' : 'FAIL'}`,
                '',
                `üéØ Overall Status: ${passRate >= 80 ? '‚úÖ READY FOR PRODUCTION' : '‚ö†Ô∏è NEEDS ATTENTION'}`
            ];
            
            const overallPassed = passRate >= 80;
            displayResult('overallResult', summary, overallPassed);
            
            // Store results globally for external access
            window.mobileTestResults = {
                summary: { totalTests, passedTests, passRate },
                details: testResults,
                timestamp: new Date().toISOString()
            };
        }
    </script>
</body>
</html>